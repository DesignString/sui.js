"use strict";
var _a;
Object.defineProperty(exports, "__esModule", { value: true });
exports.MOCKTTP_UPSTREAM_CIPHERS = void 0;
const tls = require("tls");
// We don't want to use the standard Node.js ciphers as-is, because remote servers can
// examine the TLS fingerprint to recognize they as coming from Node.js. To anonymize
// ourselves, we use a ever-so-slightly tweaked cipher config, which ensures we aren't
// easily recognizeable by default.
const defaultCiphers = ((_a = tls.DEFAULT_CIPHERS) === null || _a === void 0 ? void 0 : _a.split(':')) || []; // Standard, but not yet in the types - watch this space. [] included for browser fallback.
exports.MOCKTTP_UPSTREAM_CIPHERS = [
    // We swap the ciphers position 1 & 3. These must be already preferred ciphers,
    // at the top of the list, so this should always be safe. For Node 14, this swaps
    // TLS_AES_256_GCM_SHA384 for TLS_AES_128_GCM_SHA256. Both are modern TLS 1.3
    // options, and this order matches Firefox & cURL's current top 3 ciphers too.
    defaultCiphers[2],
    defaultCiphers[1],
    defaultCiphers[0],
    ...defaultCiphers.slice(3)
].join(':');
//# sourceMappingURL=passthrough-handling.js.map